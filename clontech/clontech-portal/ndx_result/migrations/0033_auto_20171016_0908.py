# -*- coding: utf-8 -*-
# Generated by Django 1.11.6 on 2017-10-16 09:08
from __future__ import unicode_literals

import json

from django.db import migrations


def forwards(apps, schema_editor):
    Result = apps.get_model('ndx_result', 'Result') # noqa

    for result in Result.objects.all():
        unparsed_data = json.loads(result.unparsed_data)

        try:
            result.reader_version = unparsed_data['NDXImagingVersion']
            result.save()
        except KeyError:
            pass


def backwards(apps, schema_editor):
    Result = apps.get_model('ndx_result', 'Result') # noqa

    for result in Result.objects.all():
        result.reader_version = ""
        result.save()


class Migration(migrations.Migration):

    dependencies = [
        ('ndx_result', '0032_auto_20171011_1627'),
    ]

    operations = [
        migrations.RunPython(forwards, backwards)
    ]
